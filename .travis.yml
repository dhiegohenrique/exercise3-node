language: node_js
node_js:
- 7.4.0
notifications:
  email: false
env:
  global:
  - NODE_ENV: test
before_install:
- npm install -g bower@1.8.0
- npm install -g gulp@3.9.1
- npm install -g karma-cli
- npm install -g protractor@5.1.1
- npm install -g heroku
- webdriver-manager update
- bower install
before_script:
- node server &
- sleep 10
script:
- karma start config/karma.config.js --single-run --browsers PhantomJS
- gulp
- cd dist
- git init
- git config user.name "dhiegohenrique"
- git config user.email "dhiego_henrique20@yahoo.com.br"
- git add .
- git commit -m "deploy no heroku"
- sudo apt-get install software-properties-common
- sudo add-apt-repository "deb https://cli-assets.heroku.com/branches/stable/apt ./"
- curl -L https://cli-assets.heroku.com/apt/release.key | sudo apt-key add -
- sudo apt-get update
- sudo apt-get install heroku
- heroku create teste
- git push heroku master
#before_deploy:
#- gulp
#- cd dist
# deploy:
#   provider: heroku
#   api_key: 5ef56961-7ec5-41ae-84e3-937a2caa4e8d
#   app: weatherconditions
#   #file: 'dist/*'
#   #file_glob: true
#   on:
#     repo: dhiegohenrique/exercise3-node
